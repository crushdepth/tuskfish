<!-- Custom form manager script to show or hide fields used by specific content subclasses and manage media file uploads -->
<script type="text/javascript" src="<?php echo TFISH_THEMES_URL . 'admin/tf_form.js'; ?>"></script>

<form class="form-horizontal" action="contacts.php" method="post" enctype="multipart/form-data" role="form" accept-charset="UTF-8">
    
    <div class="row">
        
    <!-- ID -->
    <input type="hidden" name="id" value="<?php echo TfishFilter::escape($contact->id); ?>">

      <!-- Title -->
      <div class="col-md-2 mb-3 text-left" id="titleContainer">
        <label for="title"><strong><?php echo TFISH_TITLE; ?></strong></label>
        <select class="form-control custom-select" name="title" id="title" required>
            <?php
                foreach ($titles as $key => $value) {
                    if ($contact->title === $key) {
                        echo '<option value="' . TfishFilter::escape($key) . '" selected>' . TfishFilter::escape($value) . '</option>';
                    } else {
                        echo '<option value="' . TfishFilter::escape($key) . '">' . TfishFilter::escape($value) . '</option>';
                    }
                }
            ?>
        </select>
      </div>
      
      <!-- Firstname -->
      <div class="col-md-3 mb-3 text-left" id="firstnameContainer">
        <label for="firstname"><strong><?php echo TFISH_FIRSTNAME; ?></strong></label>
        <input type="text" class="form-control" name="firstname" id="firstname" <?php if (isset($contact->firstname)) echo 'value="' . TfishFilter::escape($contact->firstname) . '"'; ?>>
      </div>

      <!-- Midname -->
      <div class="col-md-3 mb-3 text-left" id="midnameContainer">
        <label for="midname"><strong><?php echo TFISH_MIDNAME; ?></strong></label>
        <input type="text" class="form-control" name="midname" id="midname" <?php if (isset($contact->midname)) echo 'value="' . TfishFilter::escape($contact->midname) . '"'; ?>>
      </div>

      <!-- Lastname -->
      <div class="col-md-4 mb-3 text-left" id="lastnameContainer">
        <label for="lastname"><strong><?php echo TFISH_LASTNAME; ?></strong></label>
        <input type="text" class="form-control" name="lastname" id="lastname" <?php if (isset($contact->lastname)) echo 'value="' . TfishFilter::escape($contact->lastname) . '"'; ?>>
      </div>
      
      <!-- Job -->
      <div class="col-md-4 mb-3 text-left" id="jobContainer">
        <label for="job"><strong><?php echo TFISH_JOB; ?></strong></label>
        <input type="text" class="form-control" name="job" id="job" <?php if (isset($contact->job)) echo 'value="' . TfishFilter::escape($contact->job) . '"'; ?>>
      </div>
      
      <!-- Business unit -->
      <div class="col-md-4 mb-3 text-left" id="businessContainer">
        <label for="business_unit"><strong><?php echo TFISH_BUSINESS_UNIT; ?></strong></label>
        <input type="text" class="form-control" name="business_unit" id="business_unit" <?php if (isset($contact->business_unit)) echo 'value="' . TfishFilter::escape($contact->business_unit) . '"'; ?>>
      </div>
      
      <!-- Organisation -->
      <div class="col-md-4 mb-3 text-left" id="organisationContainer">
        <label for="organisation"><strong><?php echo TFISH_ORGANISATION; ?></strong></label>
        <input type="text" class="form-control" name="organisation" id="organisation" <?php if (isset($contact->organisation)) echo 'value="' . TfishFilter::escape($contact->organisation) . '"'; ?>>
      </div>
      
      <!-- Email -->
      <div class="col-md-4 mb-3 text-left" id="emailContainer">
        <label for="email"><strong><?php echo TFISH_EMAIL; ?></strong></label>
        <input type="text" class="form-control" name="email" id="email" <?php if (isset($contact->email)) echo 'value="' . TfishFilter::escape($contact->email) . '"'; ?>>
      </div>
      
      <!-- State -->
      <div class="col-md-4 mb-3 text-left" id="stateContainer">
        <label for="state"><strong><?php echo TFISH_STATE; ?></strong></label>
        <input type="text" class="form-control" name="state" id="state" <?php if (isset($contact->state)) echo 'value="' . TfishFilter::escape($contact->state) . '"'; ?>>
      </div>
      
      <!-- Country -->
      <div class="col-md-4 mb-3 text-left" id="countryContainer">
        <label for="country"><strong><?php echo TFISH_COUNTRY; ?></strong></label>
        <select class="form-control custom-select" name="country" id="country">
            <?php
                foreach ($country_list as $country_id => $country_title) {
                    if (isset($contact->country) && $contact->country === $country_id) {
                        echo '<option value="' . TfishFilter::escape($country_id) . '" selected>' . TfishFilter::escape($country_title) . '</option>';
                    } else {
                        echo '<option value="' . TfishFilter::escape($country_id) . '">' . TfishFilter::escape($country_title) . '</option>';
                    }
                }
            ?>
        </select>
      </div>
    
      <!-- Activities -->
      <div class="col-md-6 col-lg-4 mb-3 text-left" id="tagsContainer">
        <label for="tags"><strong><?php echo TFISH_ACTIVITIES; ?></strong></label>
          <select class="form-control custom-select" name="tags" id="tags">
            <?php
                foreach ($tags as $tag_id => $tag_title) {
                    if (isset($contact->tags) && $contact->tags === $tag_id) {
                        echo '<option value="' . TfishFilter::escape($tag_id) . '" selected>' . TfishFilter::escape($tag_title) . '</option>';
                    } else {
                        echo '<option value="' . TfishFilter::escape($tag_id) . '">' . TfishFilter::escape($tag_title) . '</option>';
                    }
                }
            ?>
          </select>
      </div>
      
      <!-- Mobile -->
      <div class="col-md-4 mb-3 text-left" id="mobileContainer">
        <label for="mobile"><strong><?php echo TFISH_MOBILE; ?></strong></label>
        <input type="text" class="form-control" name="mobile" id="mobile" <?php if (isset($contact->mobile)) echo 'value="' . TfishFilter::escape($contact->mobile) . '"'; ?>>
      </div>
      
      <!-- Gender -->
      <div class="col-md-2 mb-3 text-left" id="genderContainer">
        <p><strong><?php echo TFISH_GENDER; ?></strong></p>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="male" name="gender" value="1" checked class="custom-control-input" required <?php if ($contact->gender === 1) { echo 'checked="checked"'; } ?>>
            <label class="custom-control-label" for="male"><?php echo TFISH_MALE; ?></label>
        </div>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="female" name="gender" value="2" class="custom-control-input" required <?php if ($contact->gender === 2) { echo 'checked="checked"'; } ?>>
            <label class="custom-control-label" for="female"><?php echo TFISH_FEMALE; ?></label>
        </div>
        <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="unknown" name="gender" value="3" class="custom-control-input" required <?php if ($contact->gender === 3) { echo 'checked="checked"'; } ?>>
            <label class="custom-control-label" for="unknown"><?php echo TFISH_UNKNOWN_GENDER; ?></label>
        </div>
      </div>
    
    </div> <!-- /row -->

    <!-- Action buttons -->
    <div class="float-left clearfix">
        <button class="btn btn-primary" onclick="this.form.elements.op.value = '<?php echo TfishFilter::escape($op); ?>';
                submit()"><?php echo TfishFilter::escape($action); ?></button>
        <button class="btn btn-primary" onclick="this.form.elements.op.value = '';
                submit()" formnovalidate><?php echo TFISH_CANCEL; ?></button>
    </div>
    
    <!-- Note that the default $op value MUST be passed in by the controller. It can be modified onChange of the type select box -->
    <input type="hidden" name="op" id="op" value="<?php echo $op; ?>" />
    
    <!-- CSRF validation token -->
    <input type="hidden" name="token" value="<?php echo $_SESSION['token']; ?>" />

</form>
