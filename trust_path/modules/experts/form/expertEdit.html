<?php declare(strict_types=1); ?>

<form class="form-horizontal" action="experts.php" method="post" enctype="multipart/form-data" role="form" accept-charset="UTF-8">
    
  <div class="row">
      
    <!-- ID -->
    <input type="hidden" name="id" value="<?php echo $tfValidator->escapeForXss($expert->id); ?>">
    
    <!-- Salutation -->
    <div class="col-md-2 mb-3 text-left" id="salutationContainer">
      <label for="salutation"><strong><?php echo TFISH_EXPERTS_SALUTATION; ?></strong></label>
      <select class="form-control custom-select" name="salutation" id="salutation">
        <?php
            foreach ($salutationList as $key => $salutation) {
                if ($expert->salutation === $key) {
                    echo '<option value="' . $tfValidator->escapeForXss($key) . '" selected>' . $tfValidator->escapeForXss($salutation) . '</option>';
                } else {
                    echo '<option value="' . $tfValidator->escapeForXss($key) . '">' . $tfValidator->escapeForXss($salutation) . '</option>';
                }
            }
        ?>
        </select>
    </div>

    <!-- First name -->
    <div class="col-md-3 mb-3 text-left" id="firstNameContainer">
      <label for="firstName"><strong><?php echo TFISH_EXPERTS_FIRST_NAME; ?></strong></label>
      <input type="text" class="form-control" name="firstName" id="firstName" <?php if (isset($expert->firstName)) echo 'value="' . $tfValidator->escapeForXss($expert->firstName) . '"'; ?>>
    </div>

    <!-- Mid name -->
    <div class="col-md-3 mb-3 text-left" id="midNameContainer">
      <label for="midName"><strong><?php echo TFISH_EXPERTS_MID_NAME; ?></strong></label>
      <input type="text" class="form-control" name="midName" id="midName" <?php if (isset($expert->midName)) echo 'value="' . $tfValidator->escapeForXss($expert->midName) . '"'; ?>>
    </div>

    <!-- Last name -->
    <div class="col-md-4 mb-3 text-left" id="lastNameContainer">
      <label for="lastName"><strong><?php echo TFISH_EXPERTS_LAST_NAME; ?></strong></label>
      <input type="text" class="form-control" name="lastName" id="lastName" <?php if (isset($expert->lastName)) echo 'value="' . $tfValidator->escapeForXss($expert->lastName) . '"'; ?>>
    </div>

    <!-- Job -->
    <div class="col-md-4 mb-3 text-left" id="jobContainer">
      <label for="job"><strong><?php echo TFISH_EXPERTS_JOB; ?></strong></label>
      <input type="text" class="form-control" name="job" id="job" <?php if (isset($expert->job)) echo 'value="' . $tfValidator->escapeForXss($expert->job) . '"'; ?>>
    </div>
    
    <!-- Business unit -->
    <div class="col-md-4 mb-3 text-left" id="businessUnitContainer">
      <label for="businessUnit"><strong><?php echo TFISH_EXPERTS_BUSINESS_UNIT; ?></strong></label>
      <input type="text" class="form-control" name="businessUnit" id="businessUnit" <?php if (isset($expert->businessUnit)) echo 'value="' . $tfValidator->escapeForXss($expert->businessUnit) . '"'; ?>>
    </div>

    <!-- Organisation -->
    <div class="col-md-4 mb-3 text-left" id="organisationContainer">
      <label for="organisation"><strong><?php echo TFISH_EXPERTS_ORGANISATION; ?></strong></label>
      <input type="text" class="form-control" name="organisation" id="organisation" <?php if (isset($expert->organisation)) echo 'value="' . $tfValidator->escapeForXss($expert->organisation) . '"'; ?>>
    </div>

    <!-- Email -->
    <div class="col-md-3 mb-3 text-left" id="emailContainer">
      <label for="email"><strong><?php echo TFISH_EXPERTS_EMAIL; ?></strong></label>
      <input type="text" class="form-control" name="email" id="email" <?php if (isset($expert->email)) echo 'value="' . $tfValidator->escapeForXss($expert->email) . '"'; ?>>
    </div>
    
    <!-- Profile link -->
    <div class="col-md-3 mb-3 text-left" id="profileLinkContainer">
      <label for="profileLink"><strong><?php echo TFISH_EXPERTS_PROFILE_LINK; ?></strong></label>
      <input type="text" class="form-control" name="profileLink" id="profileLink" <?php if (isset($expert->profileLink)) echo 'value="' . $tfValidator->escapeForXss($expert->profileLink) . '"'; ?>>
    </div>

    <!-- Gender -->
    <div class="col-md-3 mb-3 text-left" id="genderContainer">
      <p><strong><?php echo TFISH_EXPERTS_GENDER; ?></strong></p>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="male" name="gender" value="1" checked class="custom-control-input" required>
        <label class="custom-control-label" for="male"><?php echo TFISH_EXPERTS_MALE; ?></label>
      </div>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="female" name="gender" value="0" class="custom-control-input" required>
        <label class="custom-control-label" for="female"><?php echo TFISH_EXPERTS_FEMALE; ?></label>
      </div>
    </div>
    
    <!-- Online status -->
    <div class="col-md-3 mb-3 text-left" id="onlineContainer">
      <p><strong><?php echo TFISH_ONLINE_STATUS; ?></strong></p>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="online" name="online" value="1" checked class="custom-control-input" required>
        <label class="custom-control-label" for="online"><?php echo TFISH_ONLINE; ?></label>
      </div>
      <div class="custom-control custom-radio custom-control-inline">
        <input type="radio" id="offline" name="online" value="0" class="custom-control-input" required>
        <label class="custom-control-label" for="offline"><?php echo TFISH_OFFLINE; ?></label>
      </div>
    </div>

    <!-- Experience -->
    <div class="col-12 mb-3 text-left" id="experienceContainer">
      <label for="experience"><strong><?php echo TFISH_EXPERTS_EXPERIENCE; ?></strong></label>
      <textarea id="experience" name="experience" class="form-control text-left"><?php if (isset($expert->experience)) { echo $expert->escapeForXss('experience', true); } ?></textarea>
    </div>

    <!-- Projects -->
    <div class="col-12 mb-3 text-left" id="projectsContainer">
      <label for="projects"><strong><?php echo TFISH_EXPERTS_PROJECTS; ?></strong></label>
      <textarea id="projects" name="projects" class="form-control text-left"><?php if (isset($expert->projects)) { echo $expert->escapeForXss('projects', true); } ?></textarea>
    </div>

    <!-- Publications -->
    <div class="col-12 mb-3 text-left" id="publicationsContainer">
      <label for="publications"><strong><?php echo TFISH_EXPERTS_PUBLICATIONS; ?></strong></label>
      <textarea id="publications" name="publications" class="form-control text-left"><?php if (isset($expert->publications)) { echo $expert->escapeForXss('publications', true); } ?></textarea>
    </div>

    <!-- Address -->
    <div class="col-12 mb-3 text-left" id="addressContainer">
      <label for="address"><strong><?php echo TFISH_EXPERTS_ADDRESS; ?></strong></label>
      <textarea id="address" name="address" rows="5" class="form-control text-left"><?php if (isset($expert->address)) echo $tfValidator->escapeForXss($expert->address); ?></textarea>
    </div>

    <!-- Country -->
    <div class="col-md-4 mb-3 text-left" id="countryContainer">
      <label for="country"><strong><?php echo TFISH_EXPERTS_COUNTRY; ?></strong></label>
      <select class="form-control custom-select" name="country" id="country" required>
        <?php
            foreach ($countryList as $key => $country) {
                if ($expert->country === $key) {
                    echo '<option value="' . $tfValidator->escapeForXss($key) . '" selected>' . $tfValidator->escapeForXss($country) . '</option>';
                } else {
                    echo '<option value="' . $tfValidator->escapeForXss($key) . '">' . $tfValidator->escapeForXss($country) . '</option>';
                }
            }
        ?>
        </select>
    </div>

    <!-- Mobile -->
    <div class="col-md-4 mb-3 text-left" id="mobileContainer">
      <label for="mobile"><strong><?php echo TFISH_EXPERTS_MOBILE; ?></strong></label>
      <input type="text" class="form-control" name="mobile" id="mobile" <?php if (isset($expert->mobile)) echo 'value="' . $tfValidator->escapeForXss($expert->mobile) . '"'; ?>>
    </div>

    <!-- Fax -->
    <div class="col-md-4 mb-3 text-left" id="faxContainer">
      <label for="fax"><strong><?php echo TFISH_EXPERTS_FAX; ?></strong></label>
      <input type="text" class="form-control" name="fax" id="fax" <?php if (isset($expert->fax)) echo 'value="' . $tfValidator->escapeForXss($expert->fax) . '"'; ?>>
    </div>
    
    <!-- Tags -->
    <div class="col-md-6 mb-3 text-left" id="tagsContainer">
      <label for="tags"><strong><?php echo TFISH_EXPERTS_TAGS; ?></strong></label>
      <select multiple class="form-control custom-select" size="7"  name="tags[]" id="tags">
          <?php
              foreach ($tagList as $tagId => $tagTitle) {
                  if (isset($expert->tags) && in_array($tagId, $expert->tags, true)) {
                      echo '<option value="' . $tfValidator->escapeForXss($tagId) . '" selected>' . $tfValidator->escapeForXss($tagTitle) . '</option>';
                  } else {
                      echo '<option value="' . $tfValidator->escapeForXss($tagId) . '">' . $tfValidator->escapeForXss($tagTitle) . '</option>';
                  }
              }
          ?>
      </select>
    </div>
    
    <!-- Image -->
    <?php if (isset($expert->image) && !empty($expert->image)): ?>
    <div class="col-md-6 mb-4 text-left" id="imageContainer">
        <label for="image"><strong><?php echo TFISH_IMAGE; ?></strong></label>
        <input id="image" name="image" type="file" data-preview-file-type="image" value="<?php echo $tfValidator->escapeForXss($expert->image); ?>">
    </div>
    <?php else: ?>
        <div class="col-md-6 mb-3 text-left" id="imageContainer">
            <label for="image"><strong><?php echo TFISH_IMAGE; ?></strong></label>
            <input id="image" name="image" type="file" data-preview-file-type="image">
        </div>
    <?php endif; ?>
    <script>
    $(document).ready(function() {
        $("#image").fileinput({
        'showUpload': false,
        'allowedFileExtensions': ["gif", "jpg", "png"],
        'previewFileType': ["image"],
        'initialPreview': '<?php if ($expert->image) echo TFISH_IMAGE_URL . $tfValidator->escapeForXss($expert->image); ?>',
        'initialPreviewAsData': true,
        'initialPreviewShowDelete': false,
        'initialPreviewDownloadUrl': '<?php if ($expert->image) echo TFISH_IMAGE_URL . $tfValidator->escapeForXss($expert->image); ?>',
        'initialCaption': '<?php if (isset($expert->image)) echo $tfValidator->escapeForXss($expert->image); ?>',
        'fileActionSettings': {
            'showDrag': false,
            'showRemove': false},
        'theme': "fa"});

        $('#image').on('fileclear', function(tf_deleteImage) {
            document.getElementById("deleteImage").value = "1";
        });
    });
    </script>

    <!-- Delete image -->
    <input type="hidden" name="deleteImage" id="deleteImage" value="0">
    
    <div class="col-md-12" id="metaHeader">
      <h2><?php echo TFISH_META_TAGS; ?><h2>
      <hr>
    </div>
    
    <!-- Meta title -->
    <div class="col-md-6 mb-3 text-left" id="metaTitleContainer">
      <label for="metaTitle"><strong><?php echo TFISH_META_TITLE; ?></strong></label>
      <input type="text" class="form-control" name="metaTitle" id="metaTitle" <?php if (isset($expert->metaTitle)) echo 'value="' . $tfValidator->escapeForXss($expert->metaTitle) . '"'; ?>>
    </div>

    <!-- SEO -->
    <div class="col-md-6 mb-3 text-left" id="seoContainer">
      <label for="seo"><strong><?php echo TFISH_SEO; ?></strong></label>
      <input type="text" class="form-control" name="seo" id="seo" <?php if (isset($expert->seo)) echo 'value="' . $tfValidator->escapeForXss($expert->seo) . '"'; ?>>
    </div>

    <!-- Meta description -->
    <div class="col-12 mb-3 text-left" id="metaDescriptionContainer">
      <label for="metaDescription"><strong><?php echo TFISH_META_DESCRIPTION; ?></strong></label>
      <input type="text" class="form-control" name="metaDescription" id="metaDescription" <?php if (isset($expert->metaDescription)) echo 'value="' . $tfValidator->escapeForXss($expert->metaDescription) . '"'; ?>>
    </div>

  </div> <!-- /row -->
    
  <!-- Action buttons -->
  <div class="float-left clearfix">
    <input type="hidden" name="token" value="<?php echo $_SESSION['token']; ?>" />
    <button name="op" value="update" type="submit" class="btn btn-primary"><?php echo TFISH_SUBMIT; ?></button>
    <button name="op" value="" type="submit" class="btn btn-primary" formnovalidate><?php echo TFISH_CANCEL; ?></button>
  </div>

</form>
